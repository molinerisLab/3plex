---
title: "R Notebook"
output: html_notebook
---

```{r}
setwd("/sto1/epigen/TPXcCRE/dataset/v13_InVitroDiff")

library(ggplot2)
library(dplyr)
z<-read.table("tpx_paramspace.fisher_select_cutoff.matrix.best.up_down", header = T)
z$mark_seqc<-as.factor(z$mark_seqc)

ggplot(data=z %>% filter(min_length==10 & cCRE_type=="dELS" & condition=="NPC_H9"), aes(x=reorder(ssRNA,-TPXcCRE_score), y=TPXcCRE_score, fill=mark_seqc))+geom_col()+facet_grid(condition~cCRE_type,scales="free_x")+theme_bw()+theme(text =element_text(size=11),axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+geom_hline(yintercept=log10(0.05),linetype="dashed")+geom_hline(yintercept=-log10(0.05), linetype="dashed")+geom_hline(yintercept=0, linetype="dotted")


#ggplot(data=z_sel, aes(x=reorder(lncRNA,-score), y=score, color=upregulated, size=len))+geom_point()+facet_wrap(~cCRE,scales="free_x",ncol=1)+theme_bw()+theme(text =element_text(size=18),axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+geom_hline(yintercept=log10(0.05),linetype="dashed")+geom_hline(yintercept=-log10(0.05), linetype="dashed")+geom_hline(yintercept=0, linetype="dotted")

```



```{r}
library(ggplot2)
library(dplyr)

z<-read.table("tpx_paramspace.fisher_select_cutoff.matrix.best.up_down", header = T)
z$mark_seqc<-as.factor(z$mark_seqc)

min_length_list <- c(8,10,12)
cCRE_type_list <- c("PLS","pELS","dELS")
condition_list <- c("HEP_H9","NPC_H9","MESENC_H1","MESEND_H1")

plot_list <- list()

for(min_len in min_length_list){
  
  for(ccre in cCRE_type_list){
    
    for(cond in condition_list){
      
      p <- ggplot(data = z %>% filter(min_length == min_len & cCRE_type == ccre & condition == cond), aes(x=reorder(ssRNA,-TPXcCRE_score), y=TPXcCRE_score, fill=mark_seqc))+geom_col()+facet_grid(condition~cCRE_type,scales="free_x")+theme_bw()+theme(text =element_text(size=11),axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+geom_hline(yintercept=log10(0.05),linetype="dashed")+geom_hline(yintercept=-log10(0.05), linetype="dashed")+geom_hline(yintercept=0, linetype="dotted")
      
      plot_list[[toString(min_len)]][[ccre]][[cond]] <- p
      
      }
    }
  }

```




```{r, fig.align='center'}

for(min_len in min_length_list){
  
  for(ccre in cCRE_type_list){
    
    for(cond in condition_list){
      
      p <- plot_list[[toString(min_len)]][[ccre]][[cond]]
      print(p)
      
    }
  }
}
      
```


