Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job stats:
job                            count    min threads    max threads
---------------------------  -------  -------------  -------------
RNAplfold_lunp                     1              1              1
RNAplfold_lunp_modif_zscore        1              1              1
add_zeros                          1              1              1
duplex_length                      1              1              1
mask_fasta                         1              1              1
pato                               1              1              1
score_best                         1              1              1
stability_best                     1              1              1
stability_tot_undercount           1              1              1
summary                            1              1              1
tpx_stability                      1              1              1
tpx_summary_clean                  1              1              1
total                             12              1              1

Select jobs to execute...

[Wed Nov 15 16:45:20 2023]
rule RNAplfold_lunp:
    input: SRA1.fa
    output: RNAplfold/SRA1_lunp, RNAplfold/SRA1_basepairs
    jobid: 6
    reason: Missing output files: RNAplfold/SRA1_lunp
    wildcards: ssRNA=SRA1
    resources: tmpdir=/tmp


		mkdir -p RNAplfold; 
		RNAplfold -W 200 -L 150 -u 8 -o < SRA1.fa; 
		mv *_lunp RNAplfold/SRA1_lunp; mv *_basepairs RNAplfold/SRA1_basepairs
	
[Wed Nov 15 16:45:22 2023]
Finished job 6.
1 of 12 steps (8%) done
Select jobs to execute...

[Wed Nov 15 16:45:22 2023]
rule RNAplfold_lunp_modif_zscore:
    input: RNAplfold/SRA1_lunp
    output: RNAplfold/SRA1_lunp.modif_zscore
    jobid: 5
    reason: Missing output files: RNAplfold/SRA1_lunp.modif_zscore; Input files updated by another job: RNAplfold/SRA1_lunp
    wildcards: ssRNA=SRA1
    resources: tmpdir=/tmp


		grep -v '#' RNAplfold/SRA1_lunp | awk '{print $(NF)}' | distMedian.py > RNAplfold/SRA1_lunp.modif_zscore
	
[Wed Nov 15 16:45:22 2023]
Finished job 5.
2 of 12 steps (17%) done
Select jobs to execute...

[Wed Nov 15 16:45:22 2023]
rule mask_fasta:
    input: RNAplfold/SRA1_lunp.modif_zscore, SRA1.fa
    output: SRA1_ssmasked.fa
    jobid: 4
    reason: Missing output files: SRA1_ssmasked.fa; Input files updated by another job: RNAplfold/SRA1_lunp.modif_zscore
    wildcards: ssRNA=SRA1
    resources: tmpdir=/tmp


		PERC=$(sort -n RNAplfold/SRA1_lunp.modif_zscore 		| awk '{all[NR] = $0} END{print all[int(NR*10/100 - 0.5)]}');
		bedtools maskfasta 			-fi SRA1.fa 			-fo SRA1_ssmasked.fa 			-bed <(awk -v perc=$PERC 'BEGIN{OFS="\t"} $1<perc {print "SRA1",NR - 1 + 4.0, NR + 4.0}' RNAplfold/SRA1_lunp.modif_zscore | bedtools merge)
	
[Wed Nov 15 16:45:22 2023]
Finished job 4.
3 of 12 steps (25%) done
Select jobs to execute...

[Wed Nov 15 16:45:22 2023]
rule duplex_length:
    input: MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.fa
    output: MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.fa.length
    jobid: 11
    reason: Missing output files: MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.fa.length
    wildcards: file_path=MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset
    resources: tmpdir=/tmp


		fasta2oneline < MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.fa 		| perl -lane 'BEGIN{$,="\t"} print $F[0],length($F[1])' > MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.fa.length
	
[Wed Nov 15 16:45:22 2023]
Finished job 11.
4 of 12 steps (33%) done
Select jobs to execute...

[Wed Nov 15 16:45:22 2023]
rule pato:
    input: SRA1_ssmasked.fa, MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.fa
    output: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx, SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary
    log: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.log
    jobid: 3
    reason: Missing output files: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary, SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx; Input files updated by another job: SRA1_ssmasked.fa
    wildcards: ssRNA=SRA1, dsDNA=MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset
    resources: tmpdir=/tmp


		OMP_NUM_THREADS=1		/opt/bin/pato 				-l  8 				-L  -1 				-e  20 				-g  40 				-fr off 				-c  1 				 				-of 1 				--chunk-size 256 				-ss SRA1_ssmasked.fa -ds MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.fa -o SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx > SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.log 2> pato_e.txt
		mv SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.out SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx
	
[Wed Nov 15 16:45:23 2023]
Finished job 3.
5 of 12 steps (42%) done
Select jobs to execute...

[Wed Nov 15 16:45:23 2023]
rule tpx_stability:
    input: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx
    output: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz, SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz.tmp
    jobid: 8
    reason: Missing output files: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz; Input files updated by another job: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx
    wildcards: path=SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset
    resources: tmpdir=/tmp


		tail -n +2 SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx | perl -pe '$_=">$_" if ($.-1)%6==0' | perl -ne 'chomp; print "$_\t"' | tr ">" "\n" | tail -n +2 > SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz.tmp
		cat SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz.tmp | tpx_thermal_stability.py | gzip > SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz
	
[Wed Nov 15 16:45:23 2023]
Finished job 8.
6 of 12 steps (50%) done
Removing temporary output SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.
Select jobs to execute...

[Wed Nov 15 16:45:23 2023]
rule tpx_summary_clean:
    input: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary
    output: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.clean
    jobid: 2
    reason: Missing output files: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.clean; Input files updated by another job: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary
    wildcards: file_path=SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset
    resources: tmpdir=/tmp


		perl -pe 'if($.==1){s/^#\s+//; s/ //g; s/-/_/g}' SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary > SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.clean
	
[Wed Nov 15 16:45:23 2023]
Finished job 2.
7 of 12 steps (58%) done
Removing temporary output SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.
Select jobs to execute...

[Wed Nov 15 16:45:23 2023]
rule stability_best:
    input: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz
    output: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.best.tpx.stability.gz
    jobid: 7
    reason: Missing output files: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.best.tpx.stability.gz; Input files updated by another job: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz
    wildcards: file_path=SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset
    resources: tmpdir=/tmp


		zcat SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz | find_best 4 14 | gzip > SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.best.tpx.stability.gz
	
[Wed Nov 15 16:45:24 2023]
Finished job 7.
8 of 12 steps (67%) done
Select jobs to execute...

[Wed Nov 15 16:45:24 2023]
rule score_best:
    input: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz
    output: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.score_best
    jobid: 9
    reason: Missing output files: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.score_best; Input files updated by another job: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz
    wildcards: file_path=SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset
    resources: tmpdir=/tmp


		bawk 'BEGIN{print "Duplex_ID","Score_best"} NR>1 {print $Duplex_ID,$Score}' SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz 		| find_best -H 1 2 > SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.score_best
	
[Wed Nov 15 16:45:24 2023]
Finished job 9.
9 of 12 steps (75%) done
Select jobs to execute...

[Wed Nov 15 16:45:24 2023]
rule stability_tot_undercount:
    input: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz
    output: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.tot_undercount
    jobid: 10
    reason: Missing output files: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.tot_undercount; Input files updated by another job: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz
    wildcards: file_path=SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset
    resources: tmpdir=/tmp


		bawk 'NR>1 {print $Duplex_ID,$TTS_start,$TTS_end,$Stability}' SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.gz 		| bedtools sort | bedtools merge -c 4 -o max | cut -f 1,4 		| bsort 		| bawk 'BEGIN{t=0; l=""; print "Duplex_ID","Stability_tot"}			{
				if($1!=l){					if(l!=""){print l,t}					t=$2; l=$1				}else{					t+=$2				}			}
			END{ print l,t}' > SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.tot_undercount
	
[Wed Nov 15 16:45:24 2023]
Finished job 10.
10 of 12 steps (83%) done
Select jobs to execute...

[Wed Nov 15 16:45:24 2023]
rule summary:
    input: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.clean, SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.best.tpx.stability.gz, SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.score_best, SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.tot_undercount, MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.fa.length
    output: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.gz
    jobid: 1
    reason: Missing output files: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.gz; Input files updated by another job: MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.fa.length, SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.clean, SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.best.tpx.stability.gz, SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.score_best, SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.tot_undercount
    wildcards: ssRNA=SRA1, dsDNA=MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset
    resources: tmpdir=/tmp


		cat SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.clean 		| translate -a -r -v -e 0 <(bawk 'BEGIN{print "Duplex_ID","Duplex_length"} {print}' MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.fa.length) 1 		| translate -a -r -v -e 0 <(bawk 'BEGIN{print "Duplex_ID","Stability_best"} NR>1 {print $Duplex_ID,$Stability}' SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.best.tpx.stability.gz) 1 		| translate -a -r -v -e 0 SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.tot_undercount 1 		| translate -a -r -v -e 0 SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.score_best 1 > SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.gz.tmp
		bawk 'NR==1 {print $0,"Stability_norm"} NR>1 {print $0,$Stability_tot/$Duplex_length}' SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.gz.tmp | gzip > SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.gz
		rm SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.gz.tmp
	
[Wed Nov 15 16:45:24 2023]
Finished job 1.
11 of 12 steps (92%) done
Removing temporary output SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.clean.
Removing temporary output SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.best.tpx.stability.gz.
Removing temporary output SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.score_best.
Removing temporary output SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.stability.tot_undercount.
Select jobs to execute...

[Wed Nov 15 16:45:24 2023]
rule add_zeros:
    input: MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.fa, SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.gz
    output: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.add_zeros.gz
    jobid: 0
    reason: Input files updated by another job: SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.gz
    wildcards: ssRNA=SRA1, dsDNA=MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset
    resources: tmpdir=/tmp


		 awk 'BEGIN{print "Duplex_ID"} match($1,/>/){split($1,a,">"); print a[2]}' MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.fa 		 | translate -a -v -e 0 <(zcat SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.gz) 1 		 | bawk 'NR==1{print} NR>1{$2="SRA1"; print}' 		 | gzip > SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.add_zeros.gz 
	
[Wed Nov 15 16:45:24 2023]
Finished job 0.
12 of 12 steps (100%) done
Removing temporary output SRA1_ssmasked-MANE.GRCh38.v1.1.refseq_genomic.Symbol.tss.1500_500.subset.tpx.summary.gz.
Complete log: .snakemake/log/2023-11-15T164520.571842.snakemake.log
